---
title: 上线检查清单
toc: true
date: 2021-08-11 19:18:35
categories: 
  - 运维开发
sidebar: auto
permalink: /devops/release-note/
---

## 上线前

- 创建任务卡
- 创建代码库上线分支
- 提前发送业务中断信息，包括邮件和悬挂系统通知
- 准备部署脚本 （例如 shell、ansible）和线上配置文件（例如Nginx配置）
- 制定上线计划
- 在低版本演练上线计划
- 在低版本演练灾备恢复
- 记录当前系统运行的版本号，软件包，需要准备好回退计划
- 有条件的，进行安全测试

## 上线

- 执行上线动作至少需要两人pair操作（大量误操作造成事故的案例），可以创建线上会议直播上线操作
- 停服后需要监控数据流量，确保流量为0后再进行数据、配置和线上软件包的备份
- 上线失败后使用回退计划
- 尽量不对线上环境进行手动配置，如果无法实现自动化部署，应添加到上线计划中

## 上线完成后

- 使用专用的 health check 接口检查系统健康状态
- 核对线上系统的版本号是否和预期一致，如果没有版本号指标，可以通过服务部署时间确
- 检查服务器负载是否在健康范围内
- 其他授权下的线上测试
- 检查日志平台是否有日志到达
- 检查日志中是否有错误信息
- 发送业务恢复邮件和系统通知
- 上线完成后，需要当前线上环境的信息更新文档
- 新的IP地址、服务器配置信息等
- 最新线上的版本号、软件包、配置文件
- 上线计划

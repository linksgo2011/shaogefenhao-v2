---
title: 技术方案 Webinar - 国际化
date: 2023-02-04 20:53:15
sidebar: true
head:
- - meta
- name: keyword
  content: xxx
  description: xxx
---

## 问题和场景

如何对软件项目考虑好、设计完善的国际化方案？

## 国际化方案遇到的坑

- 多语言
- 时间/时区
- 币种
- 单位
- 数据本地化保护（数据隐私协议，例如 GDPR）
- 跨国交易
- 跨实例交易
- 国际数据同步
- 本地业务定制（业务差异、软件风格等）
- 本地法律
- 工作方法挑战
- 远程运维/运营支持
- 国际化的服务治理

## 如何设计多语言方案？

- 字符集如何选择？
  - UTF-8-MB4
- 语言包如何设计？
  - 文案多语言（显示的标签、菜单、按钮和提示）
    - 前端做，依赖前端框架 I18N（代码中只放入 code，让框架渲染） 实现，可以通过 API 将语言包拉取到前端。
    - 非前端内容，比如邮件、短信、导入、导出、打印任务等后端业务需要处理的部分，只能手动在代码中设计。
    - 错误码的提示也算作前端做，一般不建议通过后端反馈错误内容。
  - 字典数据多语言，比如下拉菜单
    - 方案一：设计一个字典表和语言表，字典表中只放置语言表中的标签，加载字典时，通过标签加载语言数据。
    - 方案二：每个语言存一套本地语言的字典表。
    - 推荐方案：方案一，因为字典数据是开发者在维护，避免每个语言生成一套字典，减少工作量。
  - 业务数据多语言
    - 跨国交易需要的通用数据（中国大陆地区和越南）：英语+工作语言两个字段。比如，国际结算的品类，大陆地区和越南共同使用。
    - 如果是本地化的数据：每个语言区域分开创建，就不用关注语言问题。比如，本地销售的产品、订单、工单，大陆地区、印度各自维护即可。
  - 用户内容多语言
    - 不处理
- 语言的检测和选择，以及传输、存储（怎么判定我使用那个语言？）
  - 语言的检测?
    - IP 地址
    - 用户设置
    - 浏览器设置
    - 操作系统设置
  - 多语言参数传递
    - Query
    - Header【推荐】
    - 如果后端 MQ 等其他协议使用消息头即可
  - 多语言参数的存储
    - Session
    - Cookie
    - LocalStorage【推荐】

## 如何设计多时区方案？

- 使用什么格式的数据类型支持多时区？
  - 数据库
    - long
    - DataTime
    - Timestamp 【推荐】
    - String
  - Java
    - DateTime
    - LocalDateTime （作为时间表示使用） 【推荐】
    - Instant （建议作为时间计算用）
  - 服务端时区由什么决定？数据库还是业务服务实例？操作系统？前端传入？IP 地址推测？
    - 数据库：不推荐使用数据库决策时区，因为时区往往由业务含义存在，让业务系统来做。
    - JVM：完成系统相关默认时间设置，比如 createdTime，让 Java 决策。
    - 前端过来的时间相关参数数据，按照 ISO 国际化时间为准。
  - 服务器时区需要做哪些配置？
    - JVM：不要读取操作系统时区，而是自己配置一个 JVM 参数，这样不用关心基础设施配置，比如在 Docker 的 file 中配置。
- 传输
  - 数字
  - 本地字符串
  - ISO 国际化字符串编码【推荐】
- 格式化本地化展示
  - 如果解决了上面的所有问题，使用框架格式化 ISO 国际化字符串编码即可，参考框架：dayjs、moment。

## 录屏

链接: https://pan.baidu.com/s/1dn6d7LdvyDUkooX4Z-G4eA?pwd=kx92 提取码: kx92 复制这段内容后打开百度网盘手机App，操作更方便哦

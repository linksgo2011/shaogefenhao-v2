---
title: 系统管理 | 如何实现复杂数据报表?
date: 2023-04-18 22:04:32
sidebar: auto
category: 
  - 软件架构
head:
  - - meta
    - name: keyword
      content: 关键字
      description: 描述
---

报表这件事情只要是商业软件就逃不掉，那么通常报表都有哪些类型，业界都有哪些做法呢？

这里把行业中常见的报表需求类型先整理出来：

- 参数查询报表：允许用户输入参数以过滤和查询数据的报表。用户可以根据自己的需求指定查询条件，动态生成报表内容。例如在管理后台看到的订单列表，可以根据不同的查询参数获取历史数据。
- 简单统计报表：展示静态数据的基本报表，通常包含表格形式的数据展示，以某个固定的维度统计数据，比如当前的订单数量。
- 主子报表：包含主报表和子报表，主报表显示概要数据，点击主报表中的项目可以展开显示更详细的子报表数据。
- 分组报表：按某些字段对数据进行分组和汇总的报表。每个分组显示一组数据，并通常附有汇总信息，如总数、平均值等。和简单统计报表相比，这类报表往往无法通过简单的 SQL 计算，往往需要跑批任务才能完成。
- 交叉报表：也称为交叉表或透视表，通过行和列的组合来展示多维度的数据。用户可以动态地旋转行和列来分析数据的不同维度。这种报表又称为中国式报表，国内非常常见。由于行和列的表头都是从数据中提取得到的，所以相互交叉。例如，根据地区显示不同品类商品的销量就是一种典型的交叉报表。
- 数据下钻报表：允许用户从汇总数据逐步深入到更详细的数据层级的报表。用户可以通过点击高层数据查看详细信息。
- 多页 Excel 详情报表：这类报表通常需要导出打印，所以会把数据排列到 Excel 或者 PDF 中导出，也可以看做报表的一种，通常排版难度会比较高。

根据这些报表需求，通常在技术上的做法有下面这些：

- 通过普通 SQL 查询实现。
- 导出的数据列表。
- 导出的详情表。
- 通过 SQL 实时统计
- 定时任务异步统计
- 搭建开源报表引擎
- 购买商业报表引擎
- 使用数据平台计算
- 使用数据平台和 BI 工具
- 前端使用数据可视化库

这些分类方法比较繁杂，从笔者做这些报表的经验来看，有两个维度可以参考：

- 报表的开发方法：通过SQL实时统计、离线任务、基于配置的报表引擎（BI算一种增强的报表引擎）
- 报表的形态：一维表、二维表（交叉表）、详情表、嵌套表

这里解释一下。

- 一维表是指只有一个维度，和数据库表类似无限延伸；

- 二维表（交叉表）是指表中记录不是无限延伸的，需要限定在某些统计维度中，前面提到的分组报表、交叉表都是二维的；

- 详情表是把很多信息组合到一起的报表，有时候又叫做套打报表，例如一张发货单也算报表，头行是组合的，对应到领域模型中，就是发货单详情；

- 嵌套表就是把各种子报表组合到一起的报表，前面说的主子报表、数据下钻报表、多页 Excel 详情报表这些都看做嵌套报表，在实现上也是通过组合不同的子报表实现。

## 01 简单一维表的实现

## 02 二维表（交叉表）的概念和实现

## 03 详情报表

## 04 嵌套表

## 05 数据可视化的常见方法
